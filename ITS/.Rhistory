no3.aov <- aov(NO3 ~ Treatment, data = map.pat)
summary(no3.aov) #0.177  0.839
no3.aov <- aov(NO3 ~ Treatment, data = map.pat)
summary(no3.aov) #8.472 0.00201 **
# testing assumptions
# Generate residual and predicted values
no3.resids <- residuals(no3.aov)
no3.preds <- predict(no3.aov)
# Perform a Shapiro-Wilk test for normality of residuals
shapiro.test(no3.resids) # p-value = 0.02, data errors are not normally distributed
# Perform Levene's Test for homogenity of variances
leveneTest(NO3 ~ Treatment, data=map.pat, na.action=na.exclude) # p-val=0.001 variances among group are not homogenous
### RESULT: The data does not meet the normality assumption, thus I use Kruskal-Wallis test instead.
kruskal.test(NO3 ~ Treatment, data=map.pat) # Kruskal-Wallis chi-squared = 19.172, df = 2, p-value = 6.868e-05
# there are signif differences
# Do Post Hoc Dunn's Test
no3.dt <- dunnTest(NO3~Treatment, map.pat, method = "bh", kw=TRUE)
print(no3.dt,dunn.test.results=TRUE)
no3.dt$res
no3.dt.df <- as.data.frame(no3.dt$res)
no3.dt_letter = cldList(P.adj ~ Comparison,
data = no3.dt$res,
threshold = 0.05)
no3.dt_letter = column_to_rownames(no3.dt_letter, "Group" )
rownames(no3.dt_letter)
rownames(no3.dt_letter) <- c("Control","Nutrient addition","Water withholding")
no3.dt_letter = rownames_to_column(no3.dt_letter, "Treatment" )
no3_plant.summarized <- map.pat %>%
group_by(Treatment) %>%
summarize(max.no3=max(NO3))
no3_plant.summ=left_join(no3.dt_letter,no3_plant.summarized, by='Treatment')
no3_plant.summ
# create new level order and label
level_order <- c("Control","Water withholding","Nutrient addition")
label <- c("Control","Water\nwithholding","Nutrient\naddition")
# plot
no3<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NO3, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=no3_plant.summ ,aes(x=Treatment,y=8+max.no3,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="G. Nitrate (NO3-)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
no3
# plot
no3<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NO3, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=no3_plant.summ ,aes(x=Treatment,y=5+max.no3,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="G. Nitrate (NO3-)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
no3
# plot
no3<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NO3, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=no3_plant.summ ,aes(x=Treatment,y=3+max.no3,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="G. Nitrate (NO3-)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
no3
no3_plant.summ
no3.dt$res
# plot
no3<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NO3, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=no3_plant.summ ,aes(x=Treatment,y=3+max.no3,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="G. Nitrate (NO3(-))", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
no3
### 7. NH4
nh4.aov <- aov(NH4 ~ Treatment, data = map.pat)
summary(nh4.aov) #8.472 0.00201 **
# testing assumptions
# Generate residual and predicted values
nh4.resids <- residuals(nh4.aov)
nh4.preds <- predict(nh4.aov)
# Perform a Shapiro-Wilk test for normality of residuals
shapiro.test(nh4.resids) # p-value = 0.003, data errors are not normally distributed
# Perform Levene's Test for homogenity of variances
leveneTest(NH4 ~ Treatment, data=map.pat, na.action=na.exclude) # p-val=0.11 variances among group are homogenous
# there are no signif differences
# create new level order and label
level_order <- c("Control","Water withholding","Nutrient addition")
label <- c("Control","Water\nwithholding","Nutrient\naddition")
# plot
nh4<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NH4, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
labs(title="H. Ammonium (NH4(+))", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
nh4
# plot
nh4<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NH4, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
labs(title="H. Ammonium (NH4(+))", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_text(size=14,face="bold"),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
nh4
#There are no differences of Mg content among treatments
# create new level order and label
level_order <- c("Control","Water withholding","Nutrient addition")
label <- c("Control","Water\nwithholding","Nutrient\naddition")
# plot
mg<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=Mg, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="E. Magnesium (Mg)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
mg
# plot
mg<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=Mg, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="E. Magnesium (Mg)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_text(size=14),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
mg
# plot
mg<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=Mg, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="E. Magnesium (Mg)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_text(size=14),
axis.title.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
mg
# plot
om<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=OM, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="F. Organic Matter (OM)", y="Percent (%)")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text=element_text(size=14),
axis.title.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
om
# plot
no3<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NO3, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=no3_plant.summ ,aes(x=Treatment,y=3+max.no3,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="G. Nitrate (NO3(-))", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text=element_text(size=14),
axis.title.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
no3
# plot
nh4<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=NH4, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
labs(title="H. Ammonium (NH4(+))", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text=element_text(size=14),
axis.title.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
nh4
# Figure 5. Soil Chemistry
soilchem <- garrange(ph, p, k, ca, mg, om, no3, nh4,
ncol = 4, nrow = 2, align = "hv")
# Figure 3. Make PCoA plot for bacteria and fungi in the same panel
library(gridExtra)
# Figure 5. Soil Chemistry
soilchem <- garrange(ph, p, k, ca, mg, om, no3, nh4,
ncol = 4, nrow = 2, align = "hv")
# Figure 5. Soil Chemistry
soilchem <- ggarrange(ph, p, k, ca, mg, om, no3, nh4,
ncol = 4, nrow = 2, align = "hv")
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 12, height= 7,
units= "in", dpi = 600)
setwd('/Users/arifinabintarti/Documents/BioRxiv_Seed_Microbiome_2020/)
setwd('/Users/arifinabintarti/Documents/BioRxiv_Seed_Microbiome_2020/)
)
setwd('/Users/arifinabintarti/Documents/BioRxiv_Seed_Microbiome_2020')
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 13, height= 5,
units= "in", dpi = 600)
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 14, height= 6.5,
units= "in", dpi = 600)
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 15, height= 7,
units= "in", dpi = 600)
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 16, height= 7,
units= "in", dpi = 600)
ggsave("Soil Chemistry .tiff",
soilchem, device = "tiff",
width = 16.5, height= 7.5,
units= "in", dpi = 600)
ph.dt$res
p.dt$res
k.dt$res
k
1.160786e-02
9.330341e-02
hist(map.pat$Mg)
hist(map.pat$Ca)
### 5. Mg
mg.aov <- aov(Mg ~ Treatment, data = map.pat)
summary(mg.aov) #1.692  0.208
# testing assumptions
# Generate residual and predicted values
mg.resids <- residuals(mg.aov)
mg.preds <- predict(mg.aov)
# Perform a Shapiro-Wilk test for normality of residuals
shapiro.test(mg.resids) # p-value = 0.02, data errors are not normally distributed
hist(map.pat$OM)
no3.dt$res
summary(nh4.aov) #0.343  0.713
summary(nh4.aov) #0.343  0.713
summary(ca.aov) #2.035  0.156
# plot
p<-ggplot(map.pat, aes(x=factor(Treatment, level=level_order), y=P, fill=Treatment)) +
geom_boxplot()+
scale_fill_manual(labels = c("Control", "Water withholding", "Nutrient addition"),values=c('#4363d8', '#008080', 'tomato'))+
geom_jitter(position = position_jitter(width = 0.1, height = 0, seed=13), alpha=0.5)+
theme_bw()+
expand_limits(x = 0, y = 0)+
geom_text(data=p_plant.summ ,aes(x=Treatment,y=5+max.p,label=Letter),vjust=0)+
#geom_errorbar(aes(ymin = mean.podnum - sd.podnum, ymax = mean.podnum + sd.podnum), width=0.2)+
labs(title="B. Phosphorus (P)", y="ppm")+
scale_x_discrete(labels= label)+
theme(legend.position="none",
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 15, face="bold"),
axis.text.y=element_text(size=14),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y=element_text(size=14,face="bold"),
legend.text=element_text(size=14),
legend.title = element_text(size = 15),
legend.spacing.x = unit(0.05, 'cm'))
p
# Figure 5. Soil Chemistry
soilchem <- ggarrange(ph, p, k, ca, mg, om, no3, nh4,
ncol = 4, nrow = 2, align = "hv")
ggsave("Fig.2 Soil Chemistry.tiff",
soilchem, device = "tiff",
width = 16.5, height= 7.5,
units= "in", dpi = 600)
# the variances among groups are not homogenous,
TukeyHSD(mod) #which groups differ in relation to their variances
# the variances among groups are not homogenous,
hsd=TukeyHSD(mod) #which groups differ in relation to their variances
plot(hsd)
boxplot(mod)
mod
mod <- betadisper(otu_dist, groups)
mod
# Null hypothesis of no difference in dispersion between groups
anova(mod) # there is significant differences in dispersion between groups
## Betadisper
groups <- factor(c(rep("Control",8),rep("Water withholding",8), rep("Nutrient addition",8)))
otu_dist <- vegdist(t(otu.pat.pa), method='jaccard',binary = T)
mod <- betadisper(otu_dist, groups)
boxplot(mod)
# Null hypothesis of no difference in dispersion between groups
anova(mod) # there is significant differences in dispersion between groups
## Betadisper
groups.its <- factor(c(rep("Control",8),rep("Water withholding",7), rep("Nutrient addition",7)))
otu_its.dist <- vegdist(t(otu.its.pa), method='jaccard',binary = T)
setwd('/Users/arifinabintarti/Documents/BioRxiv_Seed_Microbiome_2020/ITS/')
wd <- print(getwd())
otu.its.pat <- read.table('04022020_pat.OpenRef_OTU_table_rare.txt', sep='\t', header=T, row.names = 1)
colnames(otu.its.pat)
#write.csv(taxonomy.rare.pat, file = "taxonomy.rare.pat.csv")
dim(otu.its.pat)
plant.its.data = read.csv("planthealthpat.its.csv", header=T)
# checking the otu table
sort(colSums(otu.its.pat, na.rm = FALSE, dims = 1), decreasing = TRUE)
head(sort(rowSums(otu.its.pat, na.rm = FALSE, dims = 1), decreasing = FALSE))
rarecurve(t(otu.its.pat), step = 20, col = "blue", cex = 0.6) #produce the rarefaction curve
# load the map
map.pat.its <- plant.its.data
otu.rare.its <- as.data.frame(otu.its.pat)
s<- specnumber(otu.rare.its, MARGIN = 2) # richness
rich <- as.data.frame(s)
h <- diversity(t(otu.rare.its), index = 'shannon') # Shannon index
shannon <- as.data.frame(h)
j <- h/log(s) # Pielou's evenness
pie <- as.data.frame(j)
map.pat.its$Richness <- s
map.pat.its$Shannon <- h
map.pat.its$Pielou <- j
map.pat.its
# 1. CALCULATE BETA DIVERSITY (PCoA PLOT) FOR Fungi
# dissimilarity indices for community ecologist to make a distance structure (Jaccard distance between samples)
otu.its.pa <- 1*(otu.its.pat>0)
otu_its.dist <- vegdist(t(otu.its.pa), method='jaccard',binary = T)
# CMD/classical multidimensional scaling (MDS) of a data matrix. Also known as principal coordinates analysis
otu_its_pcoa <- cmdscale(otu_its.dist, eig=T)
#env <- map[,c(11:22, 24:36)]
# scores of PC1 and PC2
ax1.scores.its=otu_its_pcoa$points[,1]
ax2.scores.its=otu_its_pcoa$points[,2]
#env_fit <- envfit(otu_pcoa, env, na.rm=TRUE)
# calculate percent variance explained, then add to plot
ax1.its <- otu_its_pcoa$eig[1]/sum(otu_its_pcoa$eig)
ax2.its <- otu_its_pcoa$eig[2]/sum(otu_its_pcoa$eig)
map.its=cbind(map.pat.its,ax1.scores.its,ax2.scores.its)
## Betadisper
groups.its <- factor(c(rep("Control",8),rep("Water withholding",7), rep("Nutrient addition",7)))
otu_its.dist <- vegdist(t(otu.its.pa), method='jaccard',binary = T)
mod.its<- betadisper(otu_its.dist, groups.its)
mod.its
# Null hypothesis of no difference in dispersion between groups
anova(mod.its) # there is no significant differences in dispersion between groups
